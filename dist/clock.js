"use strict";({SECOND_IN_MILLISECONDS:1e3,TOTAL_DEGREES:360,titleTextForPageInFocus:"Онлайн часы",elements:{},controls:{},CSS_DISPLAY_STATE_CLASSES:{none:"display-none",hidden:"hidden",disabled:"disabled"},MONTHS:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],WEEK_DAYS:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],settings:{mode:"digital",format:24,syncIntervalInMinutes:5},citiesOptions:{optionsTemplate:'<option id="calculated-area">Мой (часовой пояс по ip)</option>',cities:[{name:"Екатеринбург",timeZone:"Asia/Yekaterinburg"},{name:"Нижневартовск",timeZone:"Asia/Yekaterinburg"},{name:"Омск",timeZone:"Asia/Omsk"},{name:"Санкт-Петербург",timeZone:"Europe/Moscow"},{name:"Якутск",timeZone:"Asia/Yakutsk"}]},createApplicationMarkup:function(){this.elements.CLOCK_CONTAINER.innerHTML='\n            <section class="clock">\n                <div class="clock__output">\n                    <div class="clock__modes">\n                        <div id="digital" class="clock__item  clock__item--digital">\n                            <div id="digital-hours" class="clock__digital-unit  clock__digital-unit--hours"></div>\n                            <div class="clock__digital-separator">:</div>\n                            <div id="digital-minutes" class="clock__digital-unit  clock__digital-unit--minutes"></div>\n                            <div class="clock__digital-separator">:</div>\n                            <div id="digital-seconds" class="clock__digital-unit  clock__digital-unit--seconds"></div>\n                            <div id="ampm-state" class="clock__digital-ampm-state"></div>\n                        </div>\n                        <div id="analog" class="clock__item  clock__item--analog">\n                            <ol class="clock__analog-hours">\n                                <li class="clock__analog-hour-item"></li>\n                                <li class="clock__analog-hour-item"></li>\n                                <li class="clock__analog-hour-item"></li>\n                                <li class="clock__analog-hour-item"></li>\n                                <li class="clock__analog-hour-item"></li>\n                                <li class="clock__analog-hour-item"></li>\n                                <li class="clock__analog-hour-item"></li>\n                                <li class="clock__analog-hour-item"></li>\n                                <li class="clock__analog-hour-item"></li>\n                                <li class="clock__analog-hour-item"></li>\n                                <li class="clock__analog-hour-item"></li>\n                                <li class="clock__analog-hour-item"></li>\n                            </ol>\n                            <div class="clock__arrows-container">\n                                <div id="hour-arrow" class="clock__arrow-item-container">\n                                    <div class="clock__arrow  clock__arrow--hours"></div>\n                                </div>\n                                <div id="minute-arrow" class="clock__arrow-item-container">\n                                    <div class="clock__arrow  clock__arrow--minutes"></div>\n                                </div>\n                                <div id="second-arrow" class="clock__arrow-item-container">\n                                    <div class="clock__arrow  clock__arrow--seconds"></div>\n                                </div>\n                            </div>\n                        </div>\n                        <div id="date" class="clock__date"></div>\n                    </div>\n                </div>\n                <div class="clock__settings-container">\n                    <div class="clock__parameter-wrapper" id="mode-select-btns">\n                        <div class="clock__parameter-description">Вид:</div>\n                        <input type="radio" name="mode" id="digital-mode" class="clock__radio" value="digital">\n                        <label for="digital-mode" class="clock__parameter-label">Цифровые</label>\n                        <input type="radio" name="mode" id="analog-mode" class="clock__radio" value="analog">\n                        <label for="analog-mode" class="clock__parameter-label">Аналоговые</label>\n                    </div>\n                    <div class="clock__parameter-wrapper" id="format-select-btns">\n                        <div class="clock__parameter-description">Формат:</div>\n                        <input type="radio" name="format" id="full-format" class="clock__radio" value="24">\n                        <label for="full-format" class="clock__parameter-label">24 часа</label>\n                        <input type="radio" name="format" id="ampm-format" class="clock__radio" value="12">\n                        <label for="ampm-format" class="clock__parameter-label">12 часов</label>\n                    </div>\n                    <div class="clock__parameter-wrapper">\n                        <div class="clock__parameter-description">Город:</div>\n                        <select class="clock__city-selelect" id="area-select"></select> \n                    </div>\n                </div>\n            </section>',this.defineElementsAndControls()},defineElementsAndControls:function(){this.elements.DOCUMENT_TITLE=document.querySelector("title"),this.elements.DOCUMENT_BODY=document.querySelector("body"),this.elements.DIGITAL_CLOCK=document.getElementById("digital"),this.elements.ANALOG_CLOCK=document.getElementById("analog"),this.elements.DIGITAL_CLOCK_HOURS=document.getElementById("digital-hours"),this.elements.DIGITAL_CLOCK_MINUTES=document.getElementById("digital-minutes"),this.elements.DIGITAL_CLOCK_SECONDS=document.getElementById("digital-seconds"),this.elements.HOUR_ARROW=document.getElementById("hour-arrow"),this.elements.MINUTE_ARROW=document.getElementById("minute-arrow"),this.elements.SECOND_ARROW=document.getElementById("second-arrow"),this.elements.FORMAT_SETTING_CONTAINER=document.getElementById("format-select-btns"),this.elements.AMPM_STATE=document.getElementById("ampm-state"),this.elements.DATE=document.getElementById("date"),this.controls.MODE_TOGGLE_BTNS=document.querySelectorAll('#mode-select-btns input[name="mode"]'),this.controls.FORMAT_TOGGLE_BTNS=document.querySelectorAll('#format-select-btns input[name="format"]'),this.controls.AREA_SELECT=document.getElementById("area-select"),this.setInitState()},setInitState:function(){var e=this;if("digital"===this.settings.mode)this.elements.ANALOG_CLOCK.classList.add(this.CSS_DISPLAY_STATE_CLASSES.none),document.querySelector("#digital-mode").checked=!0;else if("analog"===this.settings.mode){this.elements.FORMAT_SETTING_CONTAINER.classList.add(this.CSS_DISPLAY_STATE_CLASSES.disabled);for(var t=0;t<this.controls.FORMAT_TOGGLE_BTNS.length;t++)this.controls.FORMAT_TOGGLE_BTNS[t].setAttribute("disabled",!0);this.elements.DIGITAL_CLOCK.classList.add(this.CSS_DISPLAY_STATE_CLASSES.none),document.querySelector("#analog-mode").checked=!0}24==this.settings.format?(this.elements.AMPM_STATE.classList.add(this.CSS_DISPLAY_STATE_CLASSES.none),document.querySelector("#full-format").checked=!0):12==this.settings.format&&(document.querySelector("#ampm-format").checked=!0),this.citiesOptions.cities.forEach(function(t){e.citiesOptions.optionsTemplate+='<option value="'+t.timeZone+'">'+t.name+"</option>"}),this.controls.AREA_SELECT.innerHTML=this.citiesOptions.optionsTemplate,this.elements.CALCULATED_AREA_FROM_SERVER=document.getElementById("calculated-area"),this.setHandlers()},setHandlers:function(){for(var n=this,t=0;t<this.controls.MODE_TOGGLE_BTNS.length;t++)this.controls.MODE_TOGGLE_BTNS[t].addEventListener("change",function(t){if(n.elements.DIGITAL_CLOCK.classList.toggle(n.CSS_DISPLAY_STATE_CLASSES.none),n.elements.ANALOG_CLOCK.classList.toggle(n.CSS_DISPLAY_STATE_CLASSES.none),n.elements.FORMAT_SETTING_CONTAINER.classList.toggle(n.CSS_DISPLAY_STATE_CLASSES.disabled),n.elements.DIGITAL_CLOCK.classList.contains(n.CSS_DISPLAY_STATE_CLASSES.none))for(var e=0;e<n.controls.FORMAT_TOGGLE_BTNS.length;e++)n.controls.FORMAT_TOGGLE_BTNS[e].setAttribute("disabled",!0);else for(var i=0;i<n.controls.FORMAT_TOGGLE_BTNS.length;i++)n.controls.FORMAT_TOGGLE_BTNS[i].removeAttribute("disabled");n.settings.mode=t.target.getAttribute("value")});for(var e=0;e<this.controls.FORMAT_TOGGLE_BTNS.length;e++)this.controls.FORMAT_TOGGLE_BTNS[e].addEventListener("change",function(t){n.elements.AMPM_STATE.classList.toggle(n.CSS_DISPLAY_STATE_CLASSES.none),n.settings.format=parseInt(t.target.getAttribute("value")),n.setDiditalClockValues()});this.getDateTime(!0),this.controls.AREA_SELECT.addEventListener("change",function(t){n.currentTimeZone!==t.target.value&&(n.currentTimeZone=t.target.value,n.getDateTime())}),this.elements.DOCUMENT_BODY.setAttribute("tabindex",-1),this.elements.DOCUMENT_BODY.focus(),this.elements.DOCUMENT_BODY.addEventListener("focus",function(){clearInterval(n.showTimeInDocumentTitle),n.elements.DOCUMENT_TITLE.textContent=n.titleTextForPageInFocus}),this.elements.DOCUMENT_BODY.addEventListener("blur",function(){n.showTimeInDocumentTitle=setInterval(function(){n.elements.DOCUMENT_TITLE.textContent=n.DIGITAL_CLOCK_HOURS_VALUE+":"+n.DIGITAL_CLOCK_MINUTES_VALUE+":"+n.DIGITAL_CLOCK_SECONDS_VALUE},200)})},getDateTime:function(t){var n=this,s=0<arguments.length&&void 0!==t?t:null,e=null;e=s?"https://worldtimeapi.org/api/ip":"https://worldtimeapi.org/api/timezone/"+this.currentTimeZone,fetch(e,{method:"GET",headers:{"content-type":"application/x-www-form-urlencoded"}}).then(function(t){return t.ok?t.text():Promise.reject()}).then(function(t){clearInterval(n.timeCountingInterval),clearTimeout(n.syncFromServerTimeout);var e=JSON.parse(t);n.currentTimeZone=e.timezone;var i=parseInt(e.utc_offset);n.dateAndTime=new Date(e.datetime),s?(n.CURRENT_UTC_OFFSET=i,document.getElementById("calculated-area").setAttribute("value",n.currentTimeZone)):(0!==n.CURRENT_UTC_OFFSET&&n.dateAndTime.setHours(n.dateAndTime.getHours()+n.getOppositeNumber(n.CURRENT_UTC_OFFSET)),0!==i&&n.dateAndTime.setHours(n.dateAndTime.getHours()+i)),n.setValues(s)}).catch(function(t){console.error(t)})},getOppositeNumber:function(t){return-1*t},defineDateAndClocksValues:function(){this.year=this.dateAndTime.getFullYear(),this.monthIndex=this.dateAndTime.getMonth(),this.monthDay=this.dateAndTime.getDate(),this.weekDay=this.dateAndTime.getDay(),this.hours=this.dateAndTime.getHours(),this.minutes=this.dateAndTime.getMinutes(),this.seconds=this.dateAndTime.getSeconds(),this.ampmCurrent=this.hours>this.settings.format?"pm":"am",this.elements.AMPM_STATE.textContent=this.ampmCurrent,this.elements.DATE.textContent=this.WEEK_DAYS[this.weekDay]+", "+this.monthDay+" "+this.MONTHS[this.monthIndex]+" "+this.year},setValues:function(){this.defineDateAndClocksValues(),this.setDiditalClockValues(),this.setAnalogClockArrowsPosition(),this.runTimeCounting(),this.runSyncCounting(),this.elements.DATE.textContent=this.WEEK_DAYS[this.weekDay]+", "+this.monthDay+" "+this.MONTHS[this.monthIndex]+" "+this.year},setDiditalClockValues:function(){this.createDigitalClockDataForOutput(),this.elements.DIGITAL_CLOCK_HOURS.textContent=this.DIGITAL_CLOCK_HOURS_VALUE,this.elements.DIGITAL_CLOCK_MINUTES.textContent=this.DIGITAL_CLOCK_MINUTES_VALUE,this.elements.DIGITAL_CLOCK_SECONDS.textContent=this.DIGITAL_CLOCK_SECONDS_VALUE},setAnalogClockArrowsPosition:function(){this.createAnalogClockArrowsAngles(),this.elements.HOUR_ARROW.style.transform="rotate("+this.ANALOG_CLOCK_HOUR_ARROW_ANGLE+"deg)",this.elements.MINUTE_ARROW.style.transform="rotate("+this.ANALOG_CLOCK_MINUTE_ARROW_ANGLE+"deg)",this.elements.SECOND_ARROW.style.transform="rotate("+this.ANALOG_CLOCK_SECOND_ARROW_ANGLE+"deg)"},createDigitalClockDataForOutput:function(){var t=null;12==this.settings.format?(t=this.hours>this.settings.format?this.hours-this.settings.format:this.hours,this.hours>this.settings.format&&"am"===this.ampmCurrent&&(this.ampmCurrent="pm",this.elements.AMPM_STATE.textContent=this.ampmCurrent)):t=this.hours,this.DIGITAL_CLOCK_HOURS_VALUE=this.redactValueForDigitalClock(t),this.DIGITAL_CLOCK_MINUTES_VALUE=this.redactValueForDigitalClock(this.minutes),this.DIGITAL_CLOCK_SECONDS_VALUE=this.redactValueForDigitalClock(this.seconds)},redactValueForDigitalClock:function(t){var e=String(t);return 1===e.length?"0"+e:e},createAnalogClockArrowsAngles:function(){var t=this.TOTAL_DEGREES/12,e=this.TOTAL_DEGREES/60,i=t*(12<this.hours?this.hours-12:this.hours),n=e*this.minutes,s=e*this.seconds;this.ANALOG_CLOCK_HOUR_ARROW_ANGLE=this.calculateIntermediateAngleForArrow(n,i,t),this.ANALOG_CLOCK_MINUTE_ARROW_ANGLE=this.calculateIntermediateAngleForArrow(s,n,e),this.ANALOG_CLOCK_SECOND_ARROW_ANGLE=s},calculateIntermediateAngleForArrow:function(t,e,i){return e+i/100*(t/this.TOTAL_DEGREES*100)},runTimeCounting:function(){var t=this;this.timeCountingInterval=setInterval(function(){t.dateAndTime.setSeconds(t.dateAndTime.getSeconds()+1),t.defineDateAndClocksValues(),t.setDiditalClockValues(),t.setAnalogClockArrowsPosition()},this.SECOND_IN_MILLISECONDS)},runSyncCounting:function(){var t=this;this.syncFromServerTimeout=setTimeout(function(){return t.getDateTime()},6e4*this.settings.syncIntervalInMinutes)},init:function(t,e,i){if(this.elements.CLOCK_CONTAINER=document.querySelector(t),e&&(e.mode&&("digital"===e.mode||"analog"===e.mode?this.settings.mode=e.mode:console.error("Неправильный параметр вида экранных часов\n                         (Параметр setting.mode должен иметь значение digital или analog)")),e.format&&(24==e.format||12==e.format?this.settings.format=parseInt(e.format):console.error("Некорректное значение параметра формата времени: \n                        (Параметр setting.format должен иметь значение 12 или 24)")),e.syncIntervalInMinutes&&(isNaN(e.syncIntervalInMinutes)?console.error("Некорректное значение параметра интервала синхронизации с сервером. \n                        (Параметр setting.format должен быть задан в числовом виде"):this.settings.syncIntervalInMinutes=parseInt(e.syncIntervalInMinutes))),i)if(Array.isArray(i)){i.every(function(t){return!(!t.name||"string"!=typeof t.name||!t.timeZone||"string"!=typeof t.timeZone)})?this.citiesOptions.cities=i:console.error("Некорректный массив городов. Метод принимает массив объектов, со заначениями name(string) и timeZone(string)")}else console.error("Некорректный массив городов. Метод принимает массив объектов, со заначениями name(string) и timeZone(string)");this.createApplicationMarkup()}}).init("#clock");